<button class="btn goodreads-auth display-block" (click)="triggerGoodreadsOAuth()">Authorize Access to Goodreads</button>

<div *ngIf="!authorizationLoaded" class="ui segment">
	<div class="ui active inverted dimmer">
		<div class="ui text loader">Loading</div>
	</div>
</div>
<div *ngIf="goodreads.userName && authorizationLoaded" class="authorized">
	<h1 class="ui center aligned icon header">
		<a class="goodreads-user-name" href="{{goodreads.userLink}}" target="_blank">{{goodreads.userName}}</a>'s
		<img class="ui image" id="goodreads-logo" src="//s.gr-assets.com/assets/layout/header/goodreads_logo.svg">
		Data
	</h1>
	<h2 class="ui header">
		<i class="book icon"></i>
		<div class="content">
			Your Shelves
		</div>
	</h2>
	<div class="ui styled fluid accordion" *ngIf="userShelves.length > 0">
		<span *ngFor="let shelf of userShelves; let i = index">
			<div class="title" [ngClass]="{bold: (shelf.name[0] == 'to-read')}" (click)="getBooksFromShelf(i,shelf.id[0]._,shelf.name[0])">
				<i class="dropdown icon"></i> <i class="book icon"></i>
				<a class="header">{{shelf.name[0]}}</a>
				<div class="description">{{shelf.book_count[0]._}} Books</div>
			</div>
			<div class="content">
				<div *ngIf="!shelf.books" class="ui segment">
					<div class="ui active inverted dimmer">
						<div class="ui text loader">Loading</div>
					</div>
				</div>
				<div class="ui special eight doubling cards" *ngIf="shelf.books">
					<div class="card" *ngFor="let book of shelf.books">
						<div class="blurring dimmable image" (click)="searchForLinks(book.book[0].title[0], book.book[0].authors[0].author[0].name[0], book.book[0].image_url[0], 0)">
							<div class="ui dimmer">
								<div class="content">
									<div class="center">
										<div class="ui inverted button">Get Download Links</div>
									</div>
								</div>
							</div>
							<img src="{{book.book[0].image_url[0]}}">
				    	</div>
						<div class="content">
							<a class="header" (click)="searchForLinks(book.book[0].title[0], book.book[0].authors[0].author[0].name[0], book.book[0].image_url[0], 0)">{{book.book[0].title[0]}}</a>
							<div class="meta"><span class="author">{{book.book[0].authors[0].author[0].name[0]}}</span></div>
							<div class="description">
								<p>{{book.book[0].description[0]}}</p>
							</div>
						</div>
						<div class="extra content">
							<a class="ui label" target="_blank" href="{{book.book[0].link[0]}}">
							  <i class="linkify icon"></i>
							  Goodreads Link
							</a>
							<div class="ui two statistics">
								<div class="mini statistic">
									<div class="value">
										{{book.book[0].average_rating[0]}}
									</div>
									<div class="label">
										Avg Rating
									</div>
								</div>
								<div class="mini statistic">
									<div class="value">
										{{book.book[0].ratings_count[0]}}
									</div>
									<div class="label">
										Total Ratings
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</span>
	</div>
	<div class="ui modal fullscreen google-results scrolling">
		<i class="close icon" (click)="toggleModal()"></i>
		<div class="header">Custom Google Search Results for {{bookCurrentlySearching.title}} by {{bookCurrentlySearching.author}}</div>
		<div class="image content">
			<img class="image" src="{{bookCurrentlySearching.image}}" style="height: 150px">
			<div class="description" style="width: 100%; min-height: 50px">
				<div class="ui top attached tabular menu">
		  			<a class="item" (click)="changePage(page + 1)" [ngClass]="{active: (page + 1 == bookCurrentlySearching.currentPage)}" *ngFor="let page of bookCurrentlySearching.resultPages" [attr.data-tab]="page + 1">{{page + 1}}</a>
		  			
		  			<i (click)="changePage(1)" class="angle-double-left icon" [ngClass]="{disabled: (page == 0)}"></i>
		  			<i (click)="changePage(page)" class="angle-left icon" [ngClass]="{disabled: (page == 0)}"></i>
		  			<i (click)="changePage(page + 2)" class="angle-right icon" [ngClass]="{disabled: (page + 1 == bookCurrentlySearching.resultPages.length)}"></i>
		  			<i (click)="changePage(bookCurrentlySearching.resultPages.length - 1)" class="angle-double-right icon" [ngClass]="{disabled: (page + 1 == bookCurrentlySearching.resultPages.length)}"></i>
				</div>
				<div class="ui bottom attached tab segment active" [attr.data-tab]="page" style="max-height: 70vh; overflow: scroll">
					<div *ngIf="!searchResults" class="ui segment">
						<div class="ui active inverted dimmer">
							<div class="ui text loader">Loading</div>
						</div>
					</div>
					<div *ngIf="searchResults" class="ui items">
						<a href="{{result.link}}" target="_blank" class="item" *ngFor="let result of searchResults.items">
							<div class="content">
								<a class="header" href="{{result.link}}" target="_blank">{{result.title}} ({{result.displayLink}})</a>
								<div class="meta">
							  		<span>{{result.link}}</span>
								</div>
								<div class="description">
							  		<p>{{result.snippet}}</p>
								</div>
							</div>
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- {
	"id":[{"_":"90304624","$":{"type":"integer"}}],
	"name":["on-hold-paused"],
	"book_count":[{"_":"9","$":{"type":"integer"}}],
	"exclusive_flag":[{"_":"false","$":{"type":"boolean"}}],
	"description":[{"$":{"nil":"true"}}],
	"sort":[{"$":{"nil":"true"}}],
	"order":[{"$":{"nil":"true"}}],
	"per_page":[{"$":{"type":"integer","nil":"true"}}],
	"display_fields":[""],
	"featured":[{"_":"false","$":{"type":"boolean"}}],
	"recommend_for":[{"_":"true","$":{"type":"boolean"}}],
	"sticky":[{"$":{"type":"boolean","nil":"true"}}]
} -->

<!-- {
	"book":[
		{
			"id":[{"_":"15783514","$":{"type":"integer"}}],
			"isbn":["0062255657"],
			"isbn13":["9780062255655"],
			"text_reviews_count":[{"_":"29065","$":{"type":"integer"}}],
			"title":["The Ocean at the End of the Lane"],
			"image_url":["https://d2arxad8u2l0g7.cloudfront.net/books/1351914778m/15783514.jpg"],
			"small_image_url":["https://d2arxad8u2l0g7.cloudfront.net/books/1351914778s/15783514.jpg"],
			"large_image_url":[""],
			"link":["https://www.goodreads.com/book/show/15783514-the-ocean-at-the-end-of-the-lane"],
			"num_pages":["178"],
			"format":["Hardcover"],
			"edition_information":[""],
			"publisher":["William Morrow Books"],
			"publication_day":["18"],
			"publication_year":["2013"],
			"publication_month":["6"],
			"average_rating":["3.99"],
			"ratings_count":["283192"],
			"description":["Sussex, England. A middle-aged man returns to his childhood home to attend a funeral. Although the house he lived in is long gone, he is drawn to the farm at the end of the road, where, when he was seven, he encountered a most remarkable girl, Lettie Hempstock, and her mother and grandmother. He hasn't thought of Lettie in decades, and yet as he sits by the pond (a pond that she'd claimed was an ocean) behind the ramshackle old farmhouse, the unremembered past comes flooding back. And it is a past too strange, too frightening, too dangerous to have happened to anyone, let alone a small boy.<br><br>Forty years earlier, a man committed suicide in a stolen car at this farm at the end of the road. Like a fuse on a firework, his death lit a touchpaper and resonated in unimaginable ways. The darkness was unleashed, something scary and thoroughly incomprehensible to a little boy. And Lettie—magical, comforting, wise beyond her years—promised to protect him, no matter what.<br><br>A groundbreaking work from a master, <em>The Ocean at the End of the Lane</em> is told with a rare understanding of all that makes us human, and shows the power of stories to reveal and shelter us from the darkness inside and out. It is a stirring, terrifying, and elegiac fable as delicate as a butterfly's wing and as menacing as a knife in the dark."],
			"authors":[
				{"author":
					[
						{
							"id":["1221698"],
							"name":["Neil Gaiman"],
							"role":[""],
							"image_url":[
								{
									"_":"\nhttps://d2arxad8u2l0g7.cloudfront.net/authors/1234150163p5/1221698.jpg\n",
									"$":{"nophoto":"false"}
								}
							],
							"small_image_url":[
								{
									"_":"\nhttps://d2arxad8u2l0g7.cloudfront.net/authors/1234150163p2/1221698.jpg\n",
									"$":{"nophoto":"false"}
								}
							],
							"link":["https://www.goodreads.com/author/show/1221698.Neil_Gaiman"],
							"average_rating":["4.13"],
							"ratings_count":["3697434"],
							"text_reviews_count":["205775"]
						}
					]
				}
			],
			"published":["2013"]
		}
	],
	"rating":["0"],
	"votes":["0"],
	"spoiler_flag":["false"],
	"spoilers_state":["none"],
	"shelves":[{"shelf":[{"$":{"name":"to-read","exclusive":"true","review_shelf_id":"1405053292","sortable":"true"}}]}],
	"recommended_for":[""],
	"recommended_by":[""],
	"started_at":[""],
	"read_at":[""],
	"date_added":["Thu Aug 25 18:43:42 -0700 2016"],
	"date_updated":["Thu Aug 25 18:43:43 -0700 2016"],
	"read_count":[""],
	"body":["\n  "],
	"comments_count":["0"],
	"url":["https://www.goodreads.com/review/show/1739103003"],
	"link":["https://www.goodreads.com/review/show/1739103003"],
	"owned":["0"]
} -->